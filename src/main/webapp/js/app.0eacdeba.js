(function(t){function e(e){for(var i,n,r=e[0],l=e[1],c=e[2],u=0,m=[];u<r.length;u++)n=r[u],Object.prototype.hasOwnProperty.call(o,n)&&o[n]&&m.push(o[n][0]),o[n]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(t[i]=l[i]);d&&d(e);while(m.length)m.shift()();return s.push.apply(s,c||[]),a()}function a(){for(var t,e=0;e<s.length;e++){for(var a=s[e],i=!0,r=1;r<a.length;r++){var l=a[r];0!==o[l]&&(i=!1)}i&&(s.splice(e--,1),t=n(n.s=a[0]))}return t}var i={},o={app:0},s=[];function n(e){if(i[e])return i[e].exports;var a=i[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=t,n.c=i,n.d=function(t,e,a){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(a,i,function(e){return t[e]}.bind(null,i));return a},n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],l=r.push.bind(r);r.push=e,r=r.slice();for(var c=0;c<r.length;c++)e(r[c]);var d=l;s.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"034f":function(t,e,a){"use strict";var i=a("64a9"),o=a.n(i);o.a},"35cd":function(t,e,a){},4158:function(t,e,a){},"56d7":function(t,e,a){"use strict";a.r(e);a("cadf"),a("551c"),a("f751"),a("097d");var i=a("2b0e"),o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("transition",{attrs:{mode:"out-in","enter-active-class":"bounceInLeft","leave-active-class":"fadeOut"}},[a("router-view",{staticClass:"animated"})],1)],1)},s=[],n=a("1157"),r=a.n(n),l={data:function(){return{}},created:function(){console.log("createAPP")}},c=l,d=(a("034f"),a("2877")),u=Object(d["a"])(c,o,s,!1,null,null,null),m=u.exports,p=a("5c96"),f=a.n(p);a("0fae");i["default"].use(f.a);var h=a("8c4f"),g=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticStyle:{width:"100%"}},[i("el-menu",{staticClass:"el-menu-demo",attrs:{"default-active":t.activeIndex,mode:"horizontal"}},[i("el-menu-item",{staticStyle:{cursor:"default"}},[i("img",{staticStyle:{height:"100%"},attrs:{draggable:"false",src:a("a1d8")}})]),i("el-menu-item",{attrs:{index:"/"}},[i("li",{on:{click:t.toFront}},[t._v("首页")])]),i("transition",{attrs:{name:"el-fade-in-linear"}},[t.loginState?i("el-menu-item",{attrs:{index:"/task"}},[i("li",{on:{click:t.toTaskList}},[t._v("任务列表")])]):t._e()],1),i("transition",{attrs:{name:"el-fade-in-linear"}},[t.loginState?t._e():i("el-menu-item",{staticStyle:{float:"right"}},[i("el-button",{attrs:{type:"primary",round:""},on:{click:t.login}},[t._v("登录")]),i("el-button",{attrs:{type:"primary",round:""},on:{click:t.register}},[t._v("注册")])],1)],1),i("transition",{attrs:{name:"el-fade-in-linear"}},[t.loginState?i("el-menu-item",[i("span",{staticClass:"el-icon-user-solid user-item"},[t._v("\n          欢迎您:\n          "),i("span",{staticClass:"username-item"},[t._v(t._s(t.userName))])])]):t._e()],1),i("transition",{attrs:{name:"el-fade-in-linear"}},[t.loginState?i("el-menu-item",{staticStyle:{float:"right"}},[i("el-button",{attrs:{type:"primary",round:""},on:{click:t.exit}},[t._v("退出")])],1):t._e()],1)],1),i("div",{staticClass:"main"},[i("div",{staticStyle:{"margin-top":"60px"}},[i("router-view")],1)]),t.taskPage?t._e():i("div",{staticStyle:{"margin-top":"80px"}},[i("h1",{staticStyle:{display:"inline-block","margin-right":"2em"}},[t._v("动漫大师")]),i("h2",{staticStyle:{display:"inline-block","font-style":"italic"}},[t._v("您自己的动漫制作专家")]),t.taskPage?t._e():i("div",{staticClass:"board-container"},[i("div",{staticClass:"dashboard",attrs:{id:"dashboard"},on:{dragover:t.dragOver,dragleave:t.dragLeave,drop:t.dashBoardDrop}},[i("h2",[t._v("上传文件，开始你的动画制作 ！")]),i("div",{staticClass:"board-icon file"},[i("svg",{staticClass:"icon",attrs:{t:"1568893945819",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"11152",width:"5.5em",height:"5.5em"},on:{click:t.openLoginTips}},[i("path",{attrs:{d:"M736.68 435.86a173.773 173.773 0 0 1 172.042 172.038c0.578 44.907-18.093 87.822-48.461 119.698-32.761 34.387-76.991 51.744-123.581 52.343-68.202 0.876-68.284 106.718 0 105.841 152.654-1.964 275.918-125.229 277.883-277.883 1.964-152.664-128.188-275.956-277.883-277.879-68.284-0.878-68.202 104.965 0 105.842zM285.262 779.307A173.773 173.773 0 0 1 113.22 607.266c-0.577-44.909 18.09-87.823 48.461-119.705 32.759-34.386 76.988-51.737 123.58-52.337 68.2-0.877 68.284-106.721 0-105.842C132.605 331.344 9.341 454.607 7.379 607.266 5.417 759.929 135.565 883.225 285.262 885.148c68.284 0.876 68.2-104.965 0-105.841z",fill:"#4A5699","p-id":"11153"}}),i("path",{attrs:{d:"M339.68 384.204a173.762 173.762 0 0 1 172.037-172.038c44.908-0.577 87.822 18.092 119.698 48.462 34.388 32.759 51.743 76.985 52.343 123.576 0.877 68.199 106.72 68.284 105.843 0-1.964-152.653-125.231-275.917-277.884-277.879-152.664-1.962-275.954 128.182-277.878 277.879-0.88 68.284 104.964 68.199 105.841 0z",fill:"#C45FA0","p-id":"11154"}}),i("path",{attrs:{d:"M545.039 473.078c16.542 16.542 16.542 43.356 0 59.896l-122.89 122.895c-16.542 16.538-43.357 16.538-59.896 0-16.542-16.546-16.542-43.362 0-59.899l122.892-122.892c16.537-16.542 43.355-16.542 59.894 0z",fill:"#F39A2B","p-id":"11155"}}),i("path",{attrs:{d:"M485.17 473.078c16.537-16.539 43.354-16.539 59.892 0l122.896 122.896c16.538 16.533 16.538 43.354 0 59.896-16.541 16.538-43.361 16.538-59.898 0L485.17 532.979c-16.547-16.543-16.547-43.359 0-59.901z",fill:"#F39A2B","p-id":"11156"}}),i("path",{attrs:{d:"M514.045 634.097c23.972 0 43.402 19.433 43.402 43.399v178.086c0 23.968-19.432 43.398-43.402 43.398-23.964 0-43.396-19.432-43.396-43.398V677.496c0.001-23.968 19.433-43.399 43.396-43.399z",fill:"#E5594F","p-id":"11157"}})]),t.loginState?i("input",{ref:"fileUpload",attrs:{type:"file",accept:"image/png, image/jpeg, audio/mp3, audio/mp4, video/mp4"},on:{change:t.openDialog}}):t._e()]),t._m(0)])])]),i("el-dialog",{staticStyle:{"z-index":"1000"},attrs:{title:t.fileTitle,visible:t.dialogFormVisible,"before-close":t.handleClose,center:""},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[i("el-steps",{attrs:{active:t.stepActive,"finish-status":"success","align-center":""}},[i("el-step",{attrs:{title:"选取文件"}}),i("el-step",{attrs:{title:"选择文件类型"}}),i("el-step",{attrs:{title:"选取风格并点击上传"}}),i("el-step",{attrs:{title:"等待后台处理..."}}),t.canBackLast?i("i",[i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"选错风格可以回到上一步重新选择",placement:"top"}},[i("el-button",{attrs:{circle:""},on:{click:t.backToLast}},[t._v("上一步")])],1)],1):t._e()],1),t.hasType?t._e():i("el-row",{staticStyle:{"text-align":"center","margin-bottom":"1em"}},[i("h3",[t._v("请选择您要转换的文件类型:")])]),i("transition",{attrs:{name:"el-zoom-in-center"}},[t.hasType?t._e():i("el-row",{staticStyle:{"text-align":"center","margin-bottom":"1em"}},[i("el-button",{staticClass:"fileStyleBtn",attrs:{type:"success",circle:"",disabled:t.notImage},on:{click:t.filetypeButtonI}},[i("svg",{staticClass:"icon",attrs:{t:"1568894282015",viewBox:"0 0 1213 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"13187",width:"32",height:"32"}},[i("path",{attrs:{d:"M1213.62963 1024H0V0h1213.62963zM75.851852 948.148148h1061.925926V75.851852H75.851852z",fill:"#fa5748","p-id":"13188"}}),i("path",{attrs:{d:"M541.961481 1013.001481L303.407407 774.068148l-238.554074 238.933333-53.854814-53.854814L303.407407 667.117037l292.408889 292.02963-53.854815 53.854814z",fill:"#fa5748","p-id":"13189"}}),i("path",{attrs:{d:"M1148.776296 1013.001481L758.518519 622.364444l-276.48 276.85926-53.854815-53.854815 330.334815-329.955556 444.112592 443.733334-53.854815 53.854814zM455.111111 530.962963a151.703704 151.703704 0 1 1 151.703704-151.703704 151.703704 151.703704 0 0 1-151.703704 151.703704z m0-227.555556a75.851852 75.851852 0 1 0 75.851852 75.851852 75.851852 75.851852 0 0 0-75.851852-75.851852z",fill:"#fa5748","p-id":"13190"}})]),i("div",{staticClass:"fileStyleWord"},[t._v("图片")])]),i("el-button",{staticClass:"fileStyleBtn",attrs:{type:"primary",circle:"",disabled:t.notVideo},on:{click:t.filetypeButtonV}},[i("svg",{staticClass:"icon",attrs:{t:"1568893798058",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"8225",width:"32",height:"32"}},[i("path",{attrs:{d:"M0 0m102.4 0l819.2 0q102.4 0 102.4 102.4l0 819.2q0 102.4-102.4 102.4l-819.2 0q-102.4 0-102.4-102.4l0-819.2q0-102.4 102.4-102.4Z",fill:"#C2E3C4","p-id":"8226"}}),i("path",{attrs:{d:"M102.4 0h819.2a102.4 102.4 0 0 1 102.4 102.4v122.88H0V102.4A102.4 102.4 0 0 1 102.4 0z",fill:"#FFB63D","p-id":"8227"}}),i("path",{attrs:{d:"M614.4 256h409.6l-522.24 768H92.16z",fill:"#A2CEA5","p-id":"8228"}}),i("path",{attrs:{d:"M0 225.28h1024v30.72H0z",fill:"#DD9C32","p-id":"8229"}}),i("path",{attrs:{d:"M694.75328 635.71968l-290.90816 167.936v-335.872z",fill:"#FFFFFF","p-id":"8230"}}),i("path",{attrs:{d:"M138.24 117.76m-56.32 0a56.32 56.32 0 1 0 112.64 0 56.32 56.32 0 1 0-112.64 0Z",fill:"#FFFFFF","p-id":"8231"}}),i("path",{attrs:{d:"M204.8 0h76.15488L378.88 112.64h-76.16512z",fill:"#FFFFFF","p-id":"8232"}}),i("path",{attrs:{d:"M389.12 0h76.15488L563.2 112.64h-76.16512z",fill:"#FFFFFF","p-id":"8233"}}),i("path",{attrs:{d:"M573.44 0h76.15488L747.52 112.64h-76.16512z",fill:"#FFFFFF","p-id":"8234"}}),i("path",{attrs:{d:"M757.76 0h76.15488L931.84 112.64h-76.16512z",fill:"#FFFFFF","p-id":"8235"}}),i("path",{attrs:{d:"M204.8 225.28h76.15488L378.88 112.64h-76.16512z",fill:"#FFFFFF","p-id":"8236"}}),i("path",{attrs:{d:"M389.12 225.28h76.15488L563.2 112.64h-76.16512z",fill:"#FFFFFF","p-id":"8237"}}),i("path",{attrs:{d:"M573.44 225.28h76.15488L747.52 112.64h-76.16512z",fill:"#FFFFFF","p-id":"8238"}}),i("path",{attrs:{d:"M757.76 225.28h76.15488L931.84 112.64h-76.16512z",fill:"#FFFFFF","p-id":"8239"}})]),i("div",{staticClass:"fileStyleWord"},[t._v("视频")])]),i("el-button",{staticClass:"fileStyleBtn",attrs:{type:"danger",circle:"",disabled:t.notAudio},on:{click:t.filetypeButtonA}},[i("svg",{staticClass:"icon",attrs:{t:"1568893690363",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4894",width:"32",height:"32"}},[i("path",{attrs:{d:"M849.408 6.656L411.648 140.8c-53.248 15.36-95.744 70.656-95.744 123.392v461.312S284.16 704 213.504 714.24C109.568 729.088 25.6 808.448 25.6 891.904s83.968 134.656 187.904 119.808c103.936-14.848 179.712-91.648 179.712-175.104v-445.44c0-36.864 44.544-52.736 44.544-52.736l387.072-121.344s43.008-14.336 43.008 25.088v367.616s-39.424-22.528-110.08-14.336c-103.936 12.8-187.904 90.624-187.904 174.08S653.824 905.728 757.76 893.44c103.936-12.8 187.904-90.624 187.904-174.08V74.752c-0.512-52.224-43.52-82.944-96.256-68.096z",fill:"#1296db","p-id":"4895"}})]),i("div",{staticClass:"fileStyleWord"},[t._v("音频")])])],1)],1),i("el-collapse-transition",[t.hasType?i("el-form",{staticStyle:{"margin-top":"2em"},attrs:{model:t.form}},[i("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.imageOption,expression:"imageOption"}],attrs:{label:"图像风格","label-width":t.formLabelWidth}},[i("el-select",{attrs:{placeholder:"请选择图像风格","value-key":"ims_id"},on:{change:t.esTime},model:{value:t.form.imageValue,callback:function(e){t.$set(t.form,"imageValue",e)},expression:"form.imageValue"}},t._l(t.styleResultData.data.image,(function(e){return i("el-option",{key:e.ims_id,staticStyle:{height:"5.5em"},attrs:{label:e.ims_name,value:e}},[i("span",[t._v(t._s(e.ims_name))]),i("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[t._v(t._s(e.ims_description))])])})),1)],1),i("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.audioOption,expression:"audioOption"}],attrs:{label:"音频风格","label-width":t.formLabelWidth}},[i("el-select",{attrs:{placeholder:"请选择音频风格","value-key":"aus_id"},on:{change:t.esTime},model:{value:t.form.audioValue,callback:function(e){t.$set(t.form,"audioValue",e)},expression:"form.audioValue"}},t._l(t.styleResultData.data.audio,(function(e){return i("el-option",{key:e.aus_id,staticStyle:{height:"5.5em"},attrs:{label:e.aus_name,value:e}},[i("span",[t._v(t._s(e.aus_name))]),i("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[t._v(t._s(e.aus_description))])])})),1)],1),i("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.clarityOption,expression:"clarityOption"}],attrs:{label:"清晰度","label-width":t.formLabelWidth}},[i("el-select",{attrs:{placeholder:"请选择清晰度"},model:{value:t.form.clarityValue,callback:function(e){t.$set(t.form,"clarityValue",e)},expression:"form.clarityValue"}},t._l(t.styleResultData.data.clarity,(function(e){return i("el-option",{key:e,attrs:{label:e,value:e}},[i("span",[t._v(t._s(e))])])})),1)],1),i("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.isFrameOption,expression:"isFrameOption"}],attrs:{label:"采用补帧以加速","label-width":t.formLabelWidth}},[i("el-switch",{on:{change:t.esTime},model:{value:t.fileInformation.isFrame,callback:function(e){t.$set(t.fileInformation,"isFrame",e)},expression:"fileInformation.isFrame"}})],1)],1):t._e()],1),t.hasType?i("div",{staticStyle:{"text-align":"center"}},[i("el-button",{attrs:{type:"primary"},on:{click:t.createTask}},[t._v("\n        确定上传\n        "),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"预估的后台需要的处理时间",placement:"bottom-start"}},[i("div",{staticStyle:{"margin-top":"1em"}},[i("i",[t._v("预计耗时：")]),i("i",[t._v(t._s(Number.isNaN(t.formatDuration(t.fileInformation.estimated_time))?"--：--：--":t.formatDuration(t.fileInformation.estimated_time)))])])])],1)],1):t._e()],1),t.taskPage?t._e():i("div",{staticClass:"down"},[t._m(1)])],1)},v=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"head-container"},[a("p",{staticClass:"board-head"},[t._v("拖拽文件至此或者点击上方图标")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticStyle:{color:"#46b3fcd3"}},[a("i",{staticClass:"el-icon-caret-bottom",staticStyle:{"font-weight":"bold"}})])}],w=(a("7f7f"),a("a481"),{props:{},data:function(){return{name:"main",userId:this.$route.params.userId,userName:this.$route.params.userName,activeIndex:"/",activeIndex2:"/task",loginState:!1,taskPage:!1,dialogFormVisible:!1,form:{imageValue:{},audioValue:{},clarityValue:720},formLabelWidth:"120px",styleResultData:{data:{}},stepActive:1,canBackLast:!1,hasType:!1,fileTitle:"文件名:",fileInformation:{name:"",type:"",file:{},height:1,width:1,duration:0,styleString:"",isFrame:!1,estimated_time:0},notImage:!1,notAudio:!1,notVideo:!1,imageOption:!1,audioOption:!1,clarityOption:!1,isFrameOption:!1}},created:function(){this.isLogin()},methods:{isLogin:function(){var t=this;console.log("调用了isLogin函数"),r.a.ajax({type:"POST",url:"/user/getSession"}).done((function(e){var a=e,i=a.error_code,o=t;switch(i){case 0:""!==a.data?(console.log(!0),o.loginState=!0,o.userId=a.data.userId,o.userName=a.data.userName):t.loginState=!1}}))},login:function(){this.$router.replace("/login")},register:function(){console.log("点击了注册"),this.$router.replace("/register")},toTaskList:function(){this.$router.push({name:"task"}),this.taskPage=!0},toFront:function(){this.$router.push({name:"main"}),this.taskPage=!1},exit:function(){var t=this;r.a.ajax({url:"/user/logout",type:"POST"}).done((function(){t.loginState=!1,t.$router.replace("/")}))},openLoginTips:function(){var t=this;this.loginState||this.$swal({showConfirmButton:!0,allowOutsideClick:!1,timer:3e3,type:"warning",title:"您尚未登陆",onClose:function(){t.$router.push({name:"login"})}})},backToLast:function(){this.stepActive--,this.hasType=!1,this.canBackLast=!1},openDialog:function(){var t=this,e=this.$refs.fileUpload.files[0];if("image/png"!==e.type&&"image/jpeg"!==e.type&&"audio/mp3"!==e.type&&"audio/mp4"!==e.type&&"video/mp4"!==e.type)t.$swal({showConfirmButton:!0,allowOutsideClick:!1,type:"warning",title:"不支持该格式",text:"仅支持mp4，jpg，jpeg，png，mp3,请重新选择"});else if(e.size>4e8)t.$swal({showConfirmButton:!0,allowOutsideClick:!1,type:"warning",title:"文件太大了",text:"请尝试上传小于400M的文件"});else{if(t.fileInformation.name=e.name,t.fileInformation.type=e.type,t.fileInformation.uploadFile=e,console.log(t.fileInformation),"image/png"===e.type||"image/jpeg"===e.type){var a=new FileReader;a.readAsDataURL(e),a.onload=function(e){var a=new Image;a.src=e.target.result,a.onload=function(){console.log("height:"+this.height+"----width:"+this.width),t.fileInformation.height=this.height,t.fileInformation.width=this.width,t.fileInformation.duration=0,t.notAudio=!0,t.notVideo=!0,t.dialogFormVisible=!0}}}else if("video/mp4"===e.type){t.$swal({showConfirmButton:!1,allowOutsideClick:!1,type:"info",title:"<i class='el-icon-loading'></i>",text:"文件读取中..."});var i=new FileReader;i.readAsDataURL(e),i.onload=function(e){var a=i.result,o="videoMain",s=r()('<video id="'+o+'"></video>');s.attr("src",a);var n=s[0];n.addEventListener("loadedmetadata",(function(e){console.log(n.videoWidth,n.videoHeight,n.duration),t.fileInformation.height=n.videoHeight,t.fileInformation.width=n.videoWidth,t.fileInformation.duration=n.duration,t.notImage=!1,t.notAudio=!1,t.notVideo=!1,t.dialogFormVisible=!0,t.$swal.close()}))}}else if("audio/mp3"===e.type){console.log("mp3加载中"),t.$swal({showConfirmButton:!1,allowOutsideClick:!1,type:"info",title:"<i class='el-icon-loading'></i>",text:"文件读取中..."});var o=new FileReader;o.readAsDataURL(e),o.onload=function(e){var a=o.result,i="videoMain",s=r()('<audio id="'+i+'"></audio>');s.attr("src",a);var n=s[0];n.addEventListener("loadedmetadata",(function(e){console.log(n.duration),t.fileInformation.height=1,t.fileInformation.width=1,t.fileInformation.duration=n.duration,t.notImage=!0,t.notVideo=!0,t.dialogFormVisible=!0,t.$swal.close()}))}}t.fileTitle="文件名："+e.name}},handleClose:function(t){var e=this;this.$swal({showConfirmButton:!0,allowOutsideClick:!1,type:"warning",title:"确认关闭?",text:"关闭对话框后需重新选择文件，是否确认？",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"确定关闭！"}).then((function(a){try{a.value?(e.$refs.fileUpload.value="",e.fileInformation={},e.form={imageValue:{},audioValue:{},clarityValue:720},e.stepActive=1,e.canBackLast=!1,e.hasType=!1,e.$swal({toast:!0,position:"top",timer:2e3,showConfirmButton:!1,type:"info",title:"请重新选择文件"}),t()):e.$swal({toast:!0,position:"top",timer:2e3,showConfirmButton:!1,type:"info",title:"请您继续执行步骤"})}catch(i){alert(i)}}))},calculateEsTime:function(t,e,a,i,o,s){var n;return n=o?s.frame_patch_rate*a*29.9*s.estimated_time+t*e*a*(1-s.frame_patch_rate)*i/1e6:0===a?t*e*i/1e6:t*e*a*i/1e6,n},formatDuration:function(t){if(t=Math.floor(t),t>-1){var e=Math.floor(t/3600),a=Math.floor(t/60)%60,i=t%60;t=e<10?"0"+e+":":e+":",a<10&&(t+="0"),t+=a+":",i<10&&(t+="0"),t+=i}return t},esTime:function(){this.fileInformation.estimated_time=this.calculateEsTime(1,1,this.fileInformation.duration,this.form.audioValue.aus_estimated_time)+this.calculateEsTime(this.fileInformation.width,this.fileInformation.height,this.fileInformation.duration,this.form.imageValue.ims_estimated_time,this.fileInformation.isFrame,this.styleResultData.data.patch_frame),console.log(this.fileInformation.estimated_time)},filetypeButton:function(){this.canBackLast=!0,this.hasType=!0,this.stepActive++},filetypeButtonV:function(){this.filetypeButton();var t=this;t.fileInformation.styleString="video",t.imageOption=!0,t.audioOption=!0,t.clarityOption=!0,t.isFrameOption=!0;var e=r.a.ajax({type:"POST",url:"/style/list",data:{type:"video"}});e.done((function(e){var a=e;t.styleResultData=a}))},filetypeButtonA:function(){this.filetypeButton();var t=this;t.fileInformation.styleString="audio",t.imageOption=!1,t.audioOption=!0,t.clarityOption=!1,t.isFrameOption=!1;var e=r.a.ajax({type:"POST",url:"/style/list",data:{type:"audio"}});e.done((function(e){var a=e;t.styleResultData=a,t.form.imageValue={ims_name:"原画",ims_description:"1",ims_id:1,ims_estimated_time:0,ims_show_path:"1"}}))},filetypeButtonI:function(){this.filetypeButton();var t=this;t.fileInformation.styleString="image",t.imageOption=!0,t.audioOption=!1,t.clarityOption=!0,t.isFrameOption=!1;var e=r.a.ajax({type:"POST",url:"/style/list",data:{type:"image"}});e.done((function(e){var a=e;t.styleResultData=a,t.form.audioValue={aus_description:"1",aus_id:1,aus_estimated_time:0,aus_name:"原音"}}))},createTask:function(){var t=this;t.stepActive++,t.canBackLast=!1,"undefined"===typeof t.form.imageValue.ims_id||"undefined"===typeof t.form.audioValue.aus_id?(t.$swal({type:"warning",title:"未完整填写表单，请继续操作",confirmButtonColor:"#3085d6",confirmButtonText:"确定",showCancelButton:!1}),t.stepActive--,t.canBackLast=!0):t.$swal({type:"warning",title:"确认上传并开始转换？",confirmButtonColor:"#3085d6",confirmButtonText:"确定",showCancelButton:!0,cancelButtonColor:"#d33",cancelButtonText:"取消",focusCancel:!0,reverseButtons:!0}).then((function(e){try{if(e.value){var a=new FormData;switch(t.fileInformation.styleString){case"video":console.log(fileInformation.styleString),a.set("file",t.fileInformation.uploadFile),a.append("type",t.fileInformation.styleString),a.append("estimated_time",t.fileInformation.estimated_time),a.append("ims_id",t.form.imageValue.ims_id),a.append("aus_id",t.form.imageValue.aus_id),a.append("clarity",t.form.clarityValue),a.append("is_frame_speed",t.fileInformation.isFrame),r.a.ajax({type:"POST",url:"/task/create",data:a,processData:!1,contentType:!1}).done((function(e){var a=e,i=a.error_code;switch(i){case 0:t.$swal({showConfirmButton:!0,timer:2e3,type:"success",title:"已成功上传，请耐心等待处理"});break}}));break;case"audio":a.set("file",t.fileInformation.uploadFile),a.append("type",t.fileInformation.styleString),a.append("estimated_time",t.fileInformation.estimated_time),a.append("aus_id",t.form.imageValue.aus_id),a.append("is_frame_speed",t.fileInformation.isFrame),r.a.ajax({type:"POST",url:"/task/create",data:a,processData:!1,contentType:!1}).done((function(e){var a=e,i=a.error_code;switch(i){case 0:t.$swal({showConfirmButton:!0,timer:2e3,type:"success",title:"已成功上传，请耐心等待处理"});break}}));break;case"image":a.set("file",t.fileInformation.uploadFile),a.append("type",t.fileInformation.styleString),a.append("estimated_time",t.fileInformation.estimated_time),a.append("ims_id",t.form.imageValue.ims_id),a.append("clarity",t.form.clarityValue),r.a.ajax({type:"POST",url:"/task/create",data:a,processData:!1,contentType:!1}).done((function(e){var a=e,i=a.error_code;switch(i){case 0:t.$swal({showConfirmButton:!0,timer:2e3,type:"success",title:"已成功上传，请耐心等待处理"});break}}));break}}else t.stepActive--,t.canBackLast=!0}catch(i){alert(i)}}))},dragOver:function(t){t.preventDefault(),document.getElementById("dashboard").style.borderColor="#ffdd59"},dragLeave:function(){document.getElementById("dashboard").style.borderColor="rgb(124, 219, 248)"},dashBoardDrop:function(t){document.getElementById("dashboard").style.borderColor="rgb(124, 219, 248)",t.preventDefault();var e=this;if(this.loginState){var a=t.dataTransfer.files,i=a[0];if(console.log(i),"image/png"!==i.type&&"image/jpeg"!==i.type&&"audio/mp3"!==i.type&&"audio/mp4"!==i.type&&"video/mp4"!==i.type)e.$swal({showConfirmButton:!0,allowOutsideClick:!1,type:"warning",title:"不支持该格式",text:"仅支持mp4，jpg，jpeg，png，mp3,请重新选择"});else if(i.size>4e8)e.$swal({showConfirmButton:!0,allowOutsideClick:!1,type:"warning",title:"文件太大了",text:"请尝试上传小于400M的文件"});else{if(e.fileInformation.name=i.name,e.fileInformation.type=i.type,e.fileInformation.uploadFile=i,console.log(e.fileInformation),"image/png"===i.type||"image/jpeg"===i.type){var o=new FileReader;o.readAsDataURL(i),o.onload=function(t){var a=new Image;a.src=t.target.result,a.onload=function(){console.log("height:"+this.height+"----width:"+this.width),e.fileInformation.height=this.height,e.fileInformation.width=this.width,e.fileInformation.duration=0,e.notAudio=!0,e.notVideo=!0,e.dialogFormVisible=!0}}}else if("video/mp4"===i.type){e.$swal({showConfirmButton:!1,allowOutsideClick:!1,type:"info",title:"<i class='el-icon-loading'></i>",text:"文件读取中..."});var s=new FileReader;s.readAsDataURL(i),s.onload=function(t){var a=s.result,i="videoMain",o=r()('<video id="'+i+'"></video>');o.attr("src",a);var n=o[0];n.addEventListener("loadedmetadata",(function(t){console.log(n.videoWidth,n.videoHeight,n.duration),e.fileInformation.height=n.videoHeight,e.fileInformation.width=n.videoWidth,e.fileInformation.duration=n.duration,e.notImage=!1,e.notAudio=!1,e.notVideo=!1,e.dialogFormVisible=!0,e.$swal.close()}))}}else if("audio/mp3"===i.type){console.log("mp3加载中"),e.$swal({showConfirmButton:!1,allowOutsideClick:!1,type:"info",title:"<i class='el-icon-loading'></i>",text:"文件读取中..."});var n=new FileReader;n.readAsDataURL(i),n.onload=function(t){var a=n.result,i="videoMain",o=r()('<audio id="'+i+'"></audio>');o.attr("src",a);var s=o[0];s.addEventListener("loadedmetadata",(function(t){console.log(s.duration),e.fileInformation.height=1,e.fileInformation.width=1,e.fileInformation.duration=s.duration,e.notImage=!0,e.notVideo=!0,e.dialogFormVisible=!0,e.$swal.close()}))}}e.fileTitle="文件名："+i.name}}else this.$swal({showConfirmButton:!0,allowOutsideClick:!1,timer:3e3,type:"warning",title:"您尚未登陆",onClose:function(){e.$router.push({name:"login"})}})}}}),y=w,_=(a("7bcf"),Object(d["a"])(y,g,v,!1,null,null,null)),b=_.exports,C=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"block"},[a("el-select",{attrs:{placeholder:"显示"},on:{change:t.sorting},model:{value:t.finish_state,callback:function(e){t.finish_state=e},expression:"finish_state"}},t._l(t.showOptions,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1),a("div",{staticClass:"radio"},[t._v("\n    排序：\n    "),a("el-radio-group",{on:{change:t.sorting},model:{value:t.is_desc,callback:function(e){t.is_desc=e},expression:"is_desc"}},[a("el-radio",{attrs:{label:!1}},[t._v("正序")]),a("el-radio",{attrs:{label:!0}},[t._v("倒序")])],1)],1),a("transition",{attrs:{name:"fade","enter-active-class":"animated swing","leave-active-class":"animated bounce"}},[t.showList?a("el-timeline",{attrs:{id:"tasks"}},t._l(t.resTaskList,(function(e){return a("el-timeline-item",{key:e.task_id,attrs:{placement:"top",timestamp:t.timeFormat(e.create_time),color:"#0bbd87"}},[a("el-card",[a("div",{staticClass:"clearfix",staticStyle:{"font-weight":"bold"},attrs:{slot:"header"},slot:"header"},[a("span",{staticStyle:{"margin-right":"2em"}},[t._v("任务："+t._s(e.task_id))]),a("span",{staticStyle:{"margin-right":"1em"}},[t._v("文件："+t._s(e.file_name))]),a("el-button",{staticStyle:{float:"right",padding:"0.5em"},on:{click:function(a){return t.downloadFile(e.file_id)}}},[t._v("下载")])],1),a("div",{staticStyle:{"background-color":"background-image: linear-gradient( 135deg, #ABDCFF 10%, #0396FF 100%)"}},[a("span",{staticStyle:{"margin-right":"1.5em"}},[t._v("任务类型："+t._s(e.task_type))]),a("span",{staticStyle:{"margin-right":"1.5em"}},[t._v("任务风格："+t._s(e.ims_name?e.ims_name:"")+"  "+t._s(e.aus_name?e.aus_name:""))]),a("span",{directives:[{name:"show",rawName:"v-show",value:"audio"!==e.task_type,expression:"task.task_type!=='audio'"}],staticStyle:{"margin-right":"1.5em"}},[t._v("清晰度:"+t._s(e.clarity))]),a("span",{directives:[{name:"show",rawName:"v-show",value:"video"===e.task_type,expression:"task.task_type==='video'"}]},[t._v("\n              是否采用降效加速:\n              "),a("span",{domProps:{innerHTML:t._s(e.is_frame_speed?t.icon_true:t.icon_false)}})]),a("span",{staticStyle:{float:"right"}},[a("el-tag",{attrs:{type:e.start_time?"warning":e.final_time?"success":"info"}},[t._v(t._s(e.start_time?"正在排队...":e.final_time?"正在生成..":"已完成"))])],1)])])],1)})),1):t._e()],1)],1)},F=[],k={data:function(){return{user_id:this.$parent.userId,is_desc:!1,finish_state:0,showOptions:[{value:0,label:"全部任务"},{value:-1,label:"未完成任务"},{value:1,label:"已完成任务"}],showList:!0,resTaskList:[],icon_true:'<i style="color:#409EFF" class="el-icon-success"></i>',icon_false:'<i style="color:#409EFF" class="el-icon-error"></i>'}},created:function(){this.sorting()},methods:{downloadFile:function(t){r.a.ajax({url:"/file/downloadfile",type:"POST",data:{fileId:t}}),console.log(this),console.log(t)},timeFormat:function(t){var e=new Date(t);function a(t){return t>9?t:"0"+t}var i=e.getFullYear(),o=a(e.getMonth()+1),s=a(e.getDate()),n=e.getHours(),r=a(e.getMinutes()),l=i+"/"+o+"/"+s+"  "+n+":"+r;return l},sorting:function(){var t=this;t.resTaskList=[],t.showList=!1,r.a.ajax({url:"/task/list",type:"POST",data:{user_id:t.user_id,is_desc:t.is_desc,finish_state:t.finish_state}}).done((function(e){var a=e;t.resTaskList=a.data})).fail((function(){t.$swal({showConfirmButton:!1,timer:3e3,type:"warning",title:"请求出错，请稍等"}),t.$router.replace("/")})),t.showList=!0}}},x=k,I=(a("b60b"),Object(d["a"])(x,C,F,!1,null,"5aad703a",null)),B=I.exports,S=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"row"},[a("div",{staticClass:"login"},[a("form",{staticClass:"outside-form"},[a("h2",[a("span",{staticStyle:{float:"left"}},[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"返回首页",placement:"top"}},[a("el-button",{attrs:{circle:"",type:"primary"},on:{click:t.toFront}},[a("i",{staticClass:"el-icon-back"})])],1)],1),t._v("登录\n      ")]),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"name"}},[t._v("name")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.userName,expression:"userName"}],staticClass:"form-control",attrs:{type:"text",id:"name",placeholder:"用户名",autocomplete:"off",required:"required"},domProps:{value:t.userName},on:{input:function(e){e.target.composing||(t.userName=e.target.value)}}})]),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"password"}},[t._v("password")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],staticClass:"form-control",attrs:{type:"password",id:"password",placeholder:"密码",autocomplete:"off",required:"required"},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}})]),a("div",{staticClass:"form-group form-group-bottom"},[a("input",{staticClass:"btn btn-primary",attrs:{type:"button",value:"登录"},on:{click:t.login}}),a("p",{staticClass:"form-group-display"},[t._v("\n          没有账户?\n          "),a("router-link",{attrs:{to:"register"}},[t._v("去注册")])],1)])])])])},O=[],$={data:function(){return{userName:"",password:""}},methods:{toFront:function(){this.$router.push({name:"main",params:{}})},login:function(){var t=this;console.log("yes!login"),""!==this.userName&&""!==this.password?r.a.ajax({url:"/user/login",type:"POST",data:{userName:t.userName,password:t.password},success:function(e){console.log(e);var a=e;switch(a.error_code){case 0:t.$swal({showConfirmButton:!1,timer:2e3,type:"success",title:"您已经成功登陆"}),t.$router.replace({name:"main",params:{userId:a.data.userId,userName:a.data.userName}});break;case-1:t.$swal({showConfirmButton:!0,timer:2e3,type:"warning",title:a.error_msg});break;case-2:t.$swal({showConfirmButton:!0,timer:2e3,type:"warning",title:a.error_msg});break;case-3:t.$swal({showConfirmButton:!0,timer:2e3,type:"warning",title:a.error_msg});break;default:t.$swal({showConfirmButton:!0,timer:2e3,type:"warning",title:"接口返回值错误,请重试"});break}},error:function(){t.$swal({showConfirmButton:!1,timer:3e3,type:"warning",title:"请求出错，请稍等"})}}):""===t.userName?t.$swal({toast:!0,position:"top",showConfirmButton:!1,timer:3e3,type:"warning",title:"您未完整填写用户名"}):""===t.password&&t.$swal({toast:!0,position:"top",showConfirmButton:!1,timer:3e3,type:"warning",title:"您未完整填写密码"})}}},L=$,T=(a("8999"),Object(d["a"])(L,S,O,!1,null,"72fe61b0",null)),V=T.exports,M=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"row"},[a("div",{staticClass:"sign-up"},[a("form",{staticClass:"outside-form"},[a("h2",[a("span",{staticStyle:{float:"left"}},[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"返回首页",placement:"top"}},[a("el-button",{attrs:{circle:"",type:"primary"},on:{click:t.toFront}},[a("i",{staticClass:"el-icon-back"})])],1)],1),t._v("注册\n      ")]),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"name"}},[t._v("name")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.userName,expression:"userName"}],staticClass:"form-control",attrs:{type:"text",placeholder:"用户名",autocomplete:"off",required:"required"},domProps:{value:t.userName},on:{input:function(e){e.target.composing||(t.userName=e.target.value)}}})]),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"password"}},[t._v("password")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],staticClass:"form-control",attrs:{type:"password",placeholder:"密码",autocomplete:"off",required:"required"},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}})]),a("div",{staticClass:"form-group form-group-bottom"},[a("input",{staticClass:"btn btn-primary",attrs:{type:"button",value:"注册"},on:{click:t.register}}),a("p",{staticClass:"form-group-display"},[t._v("\n          已有账户?\n          "),a("router-link",{attrs:{to:"login"}},[t._v("去登录")])],1)])])])])},N=[],j={data:function(){return{userName:"",password:""}},methods:{toFront:function(){this.$router.push({name:"main",params:{}})},register:function(){var t=this;console.log("yes!register"),""!==this.userName&&""!==this.password?r.a.ajax({url:"/user/register",type:"POST",data:{userName:t.userName,password:t.password},success:function(e){console.log(e);var a=e;switch(a.error_code){case 0:t.$swal({showConfirmButton:!1,timer:2e3,type:"success",title:"您已经成功注册，可以去登陆了"});break;case-1:t.$swal({showConfirmButton:!0,timer:2e3,type:"warning",title:a.error_msg});break;case-2:t.$swal({showConfirmButton:!0,timer:2e3,type:"warning",title:a.error_msg});break;case-3:t.$swal({showConfirmButton:!0,timer:2e3,type:"warning",title:a.error_msg});break;default:t.$swal({showConfirmButton:!0,timer:2e3,type:"warning",title:"接口返回值错误,请重试"});break}},error:function(){t.$swal({showConfirmButton:!1,timer:3e3,type:"warning",title:"请求出错，请稍等"})}}):""===t.userName?t.$swal({toast:!0,position:"top",showConfirmButton:!1,timer:3e3,type:"warning",title:"您未完整填写用户名"}):""===t.password&&t.$swal({toast:!0,position:"top",showConfirmButton:!1,timer:3e3,type:"warning",title:"您未完整填写密码"})}}},P=j,D=(a("9594"),Object(d["a"])(P,M,N,!1,null,"1f8c37d1",null)),z=D.exports;i["default"].use(h["a"]);var A=new h["a"]({mode:"history",routes:[{path:"/",name:"main",component:b,props:!0,children:[{path:"/task",name:"task",component:B,props:!0,isPublic:!1}]},{path:"/login",name:"login",component:V,isPublic:!0},{path:"/register",name:"register",component:z,isPublic:!0}]}),E=A,R=a("5886");a("4413");a("9ddc"),i["default"].use(R["a"]),i["default"].config.productionTip=!1,i["default"].mixin({data:function(){return{}},method:{}}),new i["default"]({router:E,render:function(t){return t(m)},mounted:function(){}}).$mount("#app")},"64a9":function(t,e,a){},"7bcf":function(t,e,a){"use strict";var i=a("fb13"),o=a.n(i);o.a},8999:function(t,e,a){"use strict";var i=a("35cd"),o=a.n(i);o.a},9594:function(t,e,a){"use strict";var i=a("aef8"),o=a.n(i);o.a},a1d8:function(t,e,a){t.exports=a.p+"img/logo.d6ee2cbe.png"},aef8:function(t,e,a){},b60b:function(t,e,a){"use strict";var i=a("4158"),o=a.n(i);o.a},fb13:function(t,e,a){}});
//# sourceMappingURL=app.0eacdeba.js.map